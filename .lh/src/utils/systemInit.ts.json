{
    "sourceFile": "src/utils/systemInit.ts",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 10,
            "patches": [
                {
                    "date": 1759911046491,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1759911853220,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -23,9 +23,9 @@\n     // ê¸°ë³¸ ì§€ì ì´ ì—†ìœ¼ë©´ ìƒì„±\n     let branches = await dbManager.getAllBranches();\n     if (branches.length === 0) {\n       const defaultBranch = await dbManager.addBranch({\n-        name: 'ë³¸ì‚¬',\n+        name: 'ì „ì²´',\n         address: '',\n         phone: '',\n         isActive: true\n       });\n@@ -44,9 +44,9 @@\n       role: 'ì„¼í„°ì¥',\n       employmentType: 'ì •ê·œì§',\n       permission: 'MASTER',\n       contractStartDate: new Date(),\n-      contractEndDate: new Date(Date.now() + 365 * 24 * 60 * 60 * 1000), // 1ë…„ í›„\n+      contractEndDate: null, // ì •ê·œì§ì´ë¯€ë¡œ ê³„ì•½ì¢…ë£Œì¼ ì—†ìŒ\n     });\n     \n     return true; // ìƒˆë¡œìš´ ê³„ì •ì´ ìƒì„±ë¨\n   } catch (error) {\n"
                },
                {
                    "date": 1759912075441,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -19,12 +19,14 @@\n       // ì´ë¯¸ ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ ì¡´ì¬í•¨\n       return false;\n     }\n     \n-    // ê¸°ë³¸ ì§€ì ì´ ì—†ìœ¼ë©´ ìƒì„±\n+    // ê¸°ë³¸ ì§€ì ì´ ì—†ìœ¼ë©´ ìƒì„± ('ì „ì²´' ì§€ì  ìš°ì„  í™•ì¸)\n     let branches = await dbManager.getAllBranches();\n-    if (branches.length === 0) {\n-      const defaultBranch = await dbManager.addBranch({\n+    let defaultBranch = branches.find(branch => branch.name === 'ì „ì²´');\n+    \n+    if (!defaultBranch) {\n+      defaultBranch = await dbManager.addBranch({\n         name: 'ì „ì²´',\n         address: '',\n         phone: '',\n         isActive: true\n@@ -38,9 +40,9 @@\n       loginId: SYSTEM_ADMIN_CONFIG.SYSTEM_ADMIN_LOGIN_ID,\n       password: SYSTEM_ADMIN_CONFIG.TEMP_PASSWORD,\n       email: 'admin@lavida.com', // ì„ì‹œ ì´ë©”ì¼\n       phone: '010-0000-0000', // ì„ì‹œ ì „í™”ë²ˆí˜¸\n-      branchId: branches[0].id,\n+      branchId: defaultBranch.id, // ì°¾ì€ ë˜ëŠ” ìƒì„±ëœ 'ì „ì²´' ì§€ì  ì‚¬ìš©\n       position: 'ëŒ€í‘œ',\n       role: 'ì„¼í„°ì¥',\n       employmentType: 'ì •ê·œì§',\n       permission: 'MASTER',\n"
                },
                {
                    "date": 1759912385133,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -16,26 +16,30 @@\n     const existingAdmin = await dbManager.getStaffByLoginId(SYSTEM_ADMIN_CONFIG.SYSTEM_ADMIN_LOGIN_ID);\n     \n     if (existingAdmin) {\n       // ì´ë¯¸ ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ ì¡´ì¬í•¨\n+      console.log('ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ ì´ë¯¸ ì¡´ì¬í•©ë‹ˆë‹¤.');\n       return false;\n     }\n     \n     // ê¸°ë³¸ ì§€ì ì´ ì—†ìœ¼ë©´ ìƒì„± ('ì „ì²´' ì§€ì  ìš°ì„  í™•ì¸)\n     let branches = await dbManager.getAllBranches();\n     let defaultBranch = branches.find(branch => branch.name === 'ì „ì²´');\n     \n     if (!defaultBranch) {\n+      console.log(\"'ì „ì²´' ì§€ì ì„ ìƒì„±í•©ë‹ˆë‹¤.\");\n       defaultBranch = await dbManager.addBranch({\n         name: 'ì „ì²´',\n         address: '',\n         phone: '',\n         isActive: true\n       });\n-      branches = [defaultBranch];\n+    } else {\n+      console.log(\"'ì „ì²´' ì§€ì ì´ ì´ë¯¸ ì¡´ì¬í•©ë‹ˆë‹¤.\");\n     }\n     \n     // ì‹œìŠ¤í…œ ê´€ë¦¬ì ê³„ì • ìƒì„±\n+    console.log('ì‹œìŠ¤í…œ ê´€ë¦¬ì ê³„ì •ì„ ìƒì„±í•©ë‹ˆë‹¤.');\n     await dbManager.addStaff({\n       name: SYSTEM_ADMIN_CONFIG.SYSTEM_ADMIN_DISPLAY_NAME,\n       loginId: SYSTEM_ADMIN_CONFIG.SYSTEM_ADMIN_LOGIN_ID,\n       password: SYSTEM_ADMIN_CONFIG.TEMP_PASSWORD,\n@@ -49,8 +53,9 @@\n       contractStartDate: new Date(),\n       contractEndDate: null, // ì •ê·œì§ì´ë¯€ë¡œ ê³„ì•½ì¢…ë£Œì¼ ì—†ìŒ\n     });\n     \n+    console.log('ì‹œìŠ¤í…œ ê´€ë¦¬ì ê³„ì •ì´ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.');\n     return true; // ìƒˆë¡œìš´ ê³„ì •ì´ ìƒì„±ë¨\n   } catch (error) {\n     console.error('ì‹œìŠ¤í…œ ê´€ë¦¬ì ì´ˆê¸°í™” ì‹¤íŒ¨:', error);\n     return false;\n"
                },
                {
                    "date": 1759912582472,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -6,13 +6,48 @@\n import { dbManager } from './indexedDB';\n import { SYSTEM_ADMIN_CONFIG } from '../constants/staffConstants';\n \n /**\n+ * ì¤‘ë³µëœ 'ì „ì²´' ì§€ì  ì •ë¦¬\n+ * ì—¬ëŸ¬ ê°œì˜ 'ì „ì²´' ì§€ì ì´ ìˆì„ ê²½ìš° ê°€ì¥ ì˜¤ë˜ëœ ê²ƒë§Œ ë‚¨ê¸°ê³  ë‚˜ë¨¸ì§€ ì‚­ì œ\n+ */\n+export const cleanupDuplicateBranches = async (): Promise<void> => {\n+  try {\n+    const allBranches = await dbManager.getAllBranches();\n+    const allBranchesì „ì²´ = allBranches.filter(branch => branch.name === 'ì „ì²´');\n+    \n+    if (allBranchesì „ì²´.length > 1) {\n+      console.log(`ì¤‘ë³µëœ 'ì „ì²´' ì§€ì  ${allBranchesì „ì²´.length}ê°œ ë°œê²¬, ì •ë¦¬ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤.`);\n+      \n+      // ê°€ì¥ ì˜¤ë˜ëœ ì§€ì  (ì²« ë²ˆì§¸ë¡œ ìƒì„±ëœ ì§€ì ) ì°¾ê¸°\n+      const oldestBranch = allBranchesì „ì²´.reduce((oldest, current) => \n+        oldest.createdAt < current.createdAt ? oldest : current\n+      );\n+      \n+      // ê°€ì¥ ì˜¤ë˜ëœ ì§€ì ì„ ì œì™¸í•œ ë‚˜ë¨¸ì§€ ì‚­ì œ\n+      for (const branch of allBranchesì „ì²´) {\n+        if (branch.id !== oldestBranch.id) {\n+          console.log(`ì¤‘ë³µëœ 'ì „ì²´' ì§€ì  ì‚­ì œ: ${branch.id}`);\n+          await dbManager.deleteBranch(branch.id);\n+        }\n+      }\n+      \n+      console.log(`'ì „ì²´' ì§€ì  ì •ë¦¬ ì™„ë£Œ. ë‚¨ì€ ì§€ì : ${oldestBranch.id}`);\n+    }\n+  } catch (error) {\n+    console.error('ì¤‘ë³µ ì§€ì  ì •ë¦¬ ì‹¤íŒ¨:', error);\n+  }\n+};\n+\n+/**\n  * ì‹œìŠ¤í…œ ê´€ë¦¬ì ê³„ì • ìë™ ìƒì„±\n  * ì‹œìŠ¤í…œ ìµœì´ˆ ì‹¤í–‰ ì‹œ ë˜ëŠ” ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ ì—†ì„ ë•Œ í˜¸ì¶œ\n  */\n export const initializeSystemAdmin = async (): Promise<boolean> => {\n   try {\n+    // ë¨¼ì € ì¤‘ë³µëœ 'ì „ì²´' ì§€ì  ì •ë¦¬\n+    await cleanupDuplicateBranches();\n+    \n     // ì´ë¯¸ ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸\n     const existingAdmin = await dbManager.getStaffByLoginId(SYSTEM_ADMIN_CONFIG.SYSTEM_ADMIN_LOGIN_ID);\n     \n     if (existingAdmin) {\n@@ -20,11 +55,10 @@\n       console.log('ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ ì´ë¯¸ ì¡´ì¬í•©ë‹ˆë‹¤.');\n       return false;\n     }\n     \n-    // ê¸°ë³¸ ì§€ì ì´ ì—†ìœ¼ë©´ ìƒì„± ('ì „ì²´' ì§€ì  ìš°ì„  í™•ì¸)\n-    let branches = await dbManager.getAllBranches();\n-    let defaultBranch = branches.find(branch => branch.name === 'ì „ì²´');\n+    // 'ì „ì²´' ì§€ì ì´ ì´ë¯¸ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸ (master01ê³¼ ë™ì¼í•œ ë°©ì‹)\n+    let defaultBranch = await dbManager.getBranchByName('ì „ì²´');\n     \n     if (!defaultBranch) {\n       console.log(\"'ì „ì²´' ì§€ì ì„ ìƒì„±í•©ë‹ˆë‹¤.\");\n       defaultBranch = await dbManager.addBranch({\n@@ -32,8 +66,9 @@\n         address: '',\n         phone: '',\n         isActive: true\n       });\n+      console.log(\"'ì „ì²´' ì§€ì ì´ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.\");\n     } else {\n       console.log(\"'ì „ì²´' ì§€ì ì´ ì´ë¯¸ ì¡´ì¬í•©ë‹ˆë‹¤.\");\n     }\n     \n"
                },
                {
                    "date": 1759912714483,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,138 @@\n+/**\n+ * ì‹œìŠ¤í…œ ì´ˆê¸°í™” ê´€ë ¨ ìœ í‹¸ë¦¬í‹°\n+ * ì‹œìŠ¤í…œ ê´€ë¦¬ì ìë™ ìƒì„± ë° ì´ˆê¸° ì„¤ì •\n+ */\n+\n+import { dbManager } from './indexedDB';\n+import { SYSTEM_ADMIN_CONFIG } from '../constants/staffConstants';\n+\n+/**\n+ * ì¤‘ë³µëœ 'ì „ì²´' ì§€ì  ì •ë¦¬\n+ * ì—¬ëŸ¬ ê°œì˜ 'ì „ì²´' ì§€ì ì´ ìˆì„ ê²½ìš° ê°€ì¥ ì˜¤ë˜ëœ ê²ƒë§Œ ë‚¨ê¸°ê³  ë‚˜ë¨¸ì§€ ì‚­ì œ\n+ */\n+export const cleanupDuplicateBranches = async (): Promise<void> => {\n+  try {\n+    const allBranches = await dbManager.getAllBranches();\n+    const allBranchesì „ì²´ = allBranches.filter(branch => branch.name === 'ì „ì²´');\n+    \n+    if (allBranchesì „ì²´.length > 1) {\n+      console.log(`ì¤‘ë³µëœ 'ì „ì²´' ì§€ì  ${allBranchesì „ì²´.length}ê°œ ë°œê²¬, ì •ë¦¬ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤.`);\n+      \n+      // ê°€ì¥ ì˜¤ë˜ëœ ì§€ì  (ì²« ë²ˆì§¸ë¡œ ìƒì„±ëœ ì§€ì ) ì°¾ê¸°\n+      const oldestBranch = allBranchesì „ì²´.reduce((oldest, current) => \n+        oldest.createdAt < current.createdAt ? oldest : current\n+      );\n+      \n+      // ê°€ì¥ ì˜¤ë˜ëœ ì§€ì ì„ ì œì™¸í•œ ë‚˜ë¨¸ì§€ ì‚­ì œ\n+      for (const branch of allBranchesì „ì²´) {\n+        if (branch.id !== oldestBranch.id) {\n+          console.log(`ì¤‘ë³µëœ 'ì „ì²´' ì§€ì  ì‚­ì œ: ${branch.id}`);\n+          await dbManager.deleteBranch(branch.id);\n+        }\n+      }\n+      \n+      console.log(`'ì „ì²´' ì§€ì  ì •ë¦¬ ì™„ë£Œ. ë‚¨ì€ ì§€ì : ${oldestBranch.id}`);\n+    }\n+  } catch (error) {\n+    console.error('ì¤‘ë³µ ì§€ì  ì •ë¦¬ ì‹¤íŒ¨:', error);\n+  }\n+};\n+\n+/**\n+ * ì‹œìŠ¤í…œ ê´€ë¦¬ì ê³„ì • ìë™ ìƒì„±\n+ * ì‹œìŠ¤í…œ ìµœì´ˆ ì‹¤í–‰ ì‹œ ë˜ëŠ” ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ ì—†ì„ ë•Œ í˜¸ì¶œ\n+ */\n+export const initializeSystemAdmin = async (): Promise<boolean> => {\n+  try {\n+    // ì´ë¯¸ ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸\n+    const existingAdmin = await dbManager.getStaffByLoginId(SYSTEM_ADMIN_CONFIG.SYSTEM_ADMIN_LOGIN_ID);\n+    \n+    if (existingAdmin) {\n+      // ì´ë¯¸ ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ ì¡´ì¬í•¨\n+      console.log('ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ ì´ë¯¸ ì¡´ì¬í•©ë‹ˆë‹¤.');\n+      return false;\n+    }\n+    \n+    // 'ì „ì²´' ì§€ì  í™•ì¸ ë˜ëŠ” ìƒì„± (ì›ìì  ì²˜ë¦¬ë¡œ ì¤‘ë³µ ë°©ì§€)\n+    console.log(\"'ì „ì²´' ì§€ì ì„ í™•ì¸í•˜ê±°ë‚˜ ìƒì„±í•©ë‹ˆë‹¤.\");\n+    const defaultBranch = await dbManager.getOrCreateBranchByName('ì „ì²´', {\n+      address: '',\n+      phone: '',\n+      isActive: true\n+    });\n+    console.log(\"'ì „ì²´' ì§€ì  ì²˜ë¦¬ ì™„ë£Œ:\", defaultBranch.id);\n+    \n+    // ì‹œìŠ¤í…œ ê´€ë¦¬ì ê³„ì • ìƒì„±\n+    console.log('ì‹œìŠ¤í…œ ê´€ë¦¬ì ê³„ì •ì„ ìƒì„±í•©ë‹ˆë‹¤.');\n+    await dbManager.addStaff({\n+      name: SYSTEM_ADMIN_CONFIG.SYSTEM_ADMIN_DISPLAY_NAME,\n+      loginId: SYSTEM_ADMIN_CONFIG.SYSTEM_ADMIN_LOGIN_ID,\n+      password: SYSTEM_ADMIN_CONFIG.TEMP_PASSWORD,\n+      email: 'admin@lavida.com', // ì„ì‹œ ì´ë©”ì¼\n+      phone: '010-0000-0000', // ì„ì‹œ ì „í™”ë²ˆí˜¸\n+      branchId: defaultBranch.id, // ì°¾ì€ ë˜ëŠ” ìƒì„±ëœ 'ì „ì²´' ì§€ì  ì‚¬ìš©\n+      position: 'ëŒ€í‘œ',\n+      role: 'ì„¼í„°ì¥',\n+      employmentType: 'ì •ê·œì§',\n+      permission: 'MASTER',\n+      contractStartDate: new Date(),\n+      contractEndDate: null, // ì •ê·œì§ì´ë¯€ë¡œ ê³„ì•½ì¢…ë£Œì¼ ì—†ìŒ\n+    });\n+    \n+    console.log('ì‹œìŠ¤í…œ ê´€ë¦¬ì ê³„ì •ì´ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.');\n+    return true; // ìƒˆë¡œìš´ ê³„ì •ì´ ìƒì„±ë¨\n+  } catch (error) {\n+    console.error('ì‹œìŠ¤í…œ ê´€ë¦¬ì ì´ˆê¸°í™” ì‹¤íŒ¨:', error);\n+    return false;\n+  }\n+};\n+\n+/**\n+ * ì‹œìŠ¤í…œì´ ì´ˆê¸° ì„¤ì • ìƒíƒœì¸ì§€ í™•ì¸\n+ * - ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ ê¸°ë³¸ ì •ë³´(ì„ì‹œ ì´ë©”ì¼, ì „í™”ë²ˆí˜¸)ë¥¼ ì‚¬ìš©í•˜ê³  ìˆëŠ”ì§€ í™•ì¸\n+ */\n+export const isSystemInInitialState = async (): Promise<boolean> => {\n+  try {\n+    const systemAdmin = await dbManager.getStaffByLoginId(SYSTEM_ADMIN_CONFIG.SYSTEM_ADMIN_LOGIN_ID);\n+    \n+    if (!systemAdmin) {\n+      return true; // ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ ì—†ìœ¼ë©´ ì´ˆê¸° ìƒíƒœ\n+    }\n+    \n+    // ì„ì‹œ ì •ë³´ë¥¼ ì‚¬ìš©í•˜ê³  ìˆëŠ”ì§€ í™•ì¸\n+    const hasTemporaryEmail = systemAdmin.email === 'admin@lavida.com';\n+    const hasTemporaryPhone = systemAdmin.phone === '010-0000-0000';\n+    \n+    return hasTemporaryEmail || hasTemporaryPhone;\n+  } catch (error) {\n+    console.error('ì‹œìŠ¤í…œ ì´ˆê¸° ìƒíƒœ í™•ì¸ ì‹¤íŒ¨:', error);\n+    return true; // ì˜¤ë¥˜ ì‹œ ì´ˆê¸° ìƒíƒœë¡œ ê°„ì£¼\n+  }\n+};\n+\n+/**\n+ * ì‹œìŠ¤í…œ ì´ˆê¸° ì„¤ì • ì™„ë£Œ ì²˜ë¦¬\n+ * ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ ì •ë³´ë¥¼ ì—…ë°ì´íŠ¸í–ˆì„ ë•Œ í˜¸ì¶œ\n+ */\n+export const markSystemInitialized = async (): Promise<void> => {\n+  // í˜„ì¬ëŠ” ë³„ë„ í”Œë˜ê·¸ ì—†ì´ ì‹œìŠ¤í…œ ê´€ë¦¬ì ì •ë³´ë¡œë§Œ íŒë‹¨\n+  // í•„ìš”ì‹œ localStorage ë˜ëŠ” ë³„ë„ ì„¤ì • í…Œì´ë¸” ì‚¬ìš© ê°€ëŠ¥\n+};\n+\n+/**\n+ * ì‹œìŠ¤í…œ ìµœì´ˆ ì‹¤í–‰ ì‹œ ìë™ ì´ˆê¸°í™”\n+ * App.tsxì—ì„œ í˜¸ì¶œí•˜ì—¬ ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ ì—†ìœ¼ë©´ ìë™ ìƒì„±\n+ */\n+export const autoInitializeSystem = async (): Promise<void> => {\n+  try {\n+    // ë¨¼ì € ê¸°ì¡´ ì¤‘ë³µ ë°ì´í„° ì •ë¦¬ (í•œ ë²ˆë§Œ ì‹¤í–‰)\n+    if (!localStorage.getItem('lavida_cleanup_done')) {\n+      await cleanupDuplicateBranches();\n+      localStorage.setItem('lavida_cleanup_done', 'true');\n+    }\n+    \n+    await initializeSystemAdmin();\n+  } catch (error) {\n+    console.error('ì‹œìŠ¤í…œ ìë™ ì´ˆê¸°í™” ì‹¤íŒ¨:', error);\n+  }\n+};\n"
                },
                {
                    "date": 1759912858904,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -87,10 +87,11 @@\n   }\n };\n \n /**\n- * ì‹œìŠ¤í…œì´ ì´ˆê¸° ì„¤ì • ìƒíƒœì¸ì§€ í™•ì¸\n+ * ì‹œìŠ¤í…œì´ ì´ˆê¸° ì„¤ì • ìƒíƒœì¸ì§€ í™•ì¸ (ë” ì´ìƒ ëª¨ë‹¬ íŒì—…ìš©ìœ¼ë¡œ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ)\n  * - ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ ê¸°ë³¸ ì •ë³´(ì„ì‹œ ì´ë©”ì¼, ì „í™”ë²ˆí˜¸)ë¥¼ ì‚¬ìš©í•˜ê³  ìˆëŠ”ì§€ í™•ì¸\n+ * - ì´ì œ ë‹¨ìˆœ ì •ë³´ í™•ì¸ìš©ìœ¼ë¡œë§Œ ì‚¬ìš©\n  */\n export const isSystemInInitialState = async (): Promise<boolean> => {\n   try {\n     const systemAdmin = await dbManager.getStaffByLoginId(SYSTEM_ADMIN_CONFIG.SYSTEM_ADMIN_LOGIN_ID);\n@@ -98,9 +99,9 @@\n     if (!systemAdmin) {\n       return true; // ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ ì—†ìœ¼ë©´ ì´ˆê¸° ìƒíƒœ\n     }\n     \n-    // ì„ì‹œ ì •ë³´ë¥¼ ì‚¬ìš©í•˜ê³  ìˆëŠ”ì§€ í™•ì¸\n+    // ì„ì‹œ ì •ë³´ë¥¼ ì‚¬ìš©í•˜ê³  ìˆëŠ”ì§€ í™•ì¸ (ì •ë³´ìš©ìœ¼ë¡œë§Œ ì‚¬ìš©)\n     const hasTemporaryEmail = systemAdmin.email === 'admin@lavida.com';\n     const hasTemporaryPhone = systemAdmin.phone === '010-0000-0000';\n     \n     return hasTemporaryEmail || hasTemporaryPhone;\n@@ -135,146 +136,4 @@\n   } catch (error) {\n     console.error('ì‹œìŠ¤í…œ ìë™ ì´ˆê¸°í™” ì‹¤íŒ¨:', error);\n   }\n };\n-/**\n- * ì‹œìŠ¤í…œ ì´ˆê¸°í™” ê´€ë ¨ ìœ í‹¸ë¦¬í‹°\n- * ì‹œìŠ¤í…œ ê´€ë¦¬ì ìë™ ìƒì„± ë° ì´ˆê¸° ì„¤ì •\n- */\n-\n-import { dbManager } from './indexedDB';\n-import { SYSTEM_ADMIN_CONFIG } from '../constants/staffConstants';\n-\n-/**\n- * ì¤‘ë³µëœ 'ì „ì²´' ì§€ì  ì •ë¦¬\n- * ì—¬ëŸ¬ ê°œì˜ 'ì „ì²´' ì§€ì ì´ ìˆì„ ê²½ìš° ê°€ì¥ ì˜¤ë˜ëœ ê²ƒë§Œ ë‚¨ê¸°ê³  ë‚˜ë¨¸ì§€ ì‚­ì œ\n- */\n-export const cleanupDuplicateBranches = async (): Promise<void> => {\n-  try {\n-    const allBranches = await dbManager.getAllBranches();\n-    const allBranchesì „ì²´ = allBranches.filter(branch => branch.name === 'ì „ì²´');\n-    \n-    if (allBranchesì „ì²´.length > 1) {\n-      console.log(`ì¤‘ë³µëœ 'ì „ì²´' ì§€ì  ${allBranchesì „ì²´.length}ê°œ ë°œê²¬, ì •ë¦¬ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤.`);\n-      \n-      // ê°€ì¥ ì˜¤ë˜ëœ ì§€ì  (ì²« ë²ˆì§¸ë¡œ ìƒì„±ëœ ì§€ì ) ì°¾ê¸°\n-      const oldestBranch = allBranchesì „ì²´.reduce((oldest, current) => \n-        oldest.createdAt < current.createdAt ? oldest : current\n-      );\n-      \n-      // ê°€ì¥ ì˜¤ë˜ëœ ì§€ì ì„ ì œì™¸í•œ ë‚˜ë¨¸ì§€ ì‚­ì œ\n-      for (const branch of allBranchesì „ì²´) {\n-        if (branch.id !== oldestBranch.id) {\n-          console.log(`ì¤‘ë³µëœ 'ì „ì²´' ì§€ì  ì‚­ì œ: ${branch.id}`);\n-          await dbManager.deleteBranch(branch.id);\n-        }\n-      }\n-      \n-      console.log(`'ì „ì²´' ì§€ì  ì •ë¦¬ ì™„ë£Œ. ë‚¨ì€ ì§€ì : ${oldestBranch.id}`);\n-    }\n-  } catch (error) {\n-    console.error('ì¤‘ë³µ ì§€ì  ì •ë¦¬ ì‹¤íŒ¨:', error);\n-  }\n-};\n-\n-/**\n- * ì‹œìŠ¤í…œ ê´€ë¦¬ì ê³„ì • ìë™ ìƒì„±\n- * ì‹œìŠ¤í…œ ìµœì´ˆ ì‹¤í–‰ ì‹œ ë˜ëŠ” ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ ì—†ì„ ë•Œ í˜¸ì¶œ\n- */\n-export const initializeSystemAdmin = async (): Promise<boolean> => {\n-  try {\n-    // ë¨¼ì € ì¤‘ë³µëœ 'ì „ì²´' ì§€ì  ì •ë¦¬\n-    await cleanupDuplicateBranches();\n-    \n-    // ì´ë¯¸ ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸\n-    const existingAdmin = await dbManager.getStaffByLoginId(SYSTEM_ADMIN_CONFIG.SYSTEM_ADMIN_LOGIN_ID);\n-    \n-    if (existingAdmin) {\n-      // ì´ë¯¸ ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ ì¡´ì¬í•¨\n-      console.log('ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ ì´ë¯¸ ì¡´ì¬í•©ë‹ˆë‹¤.');\n-      return false;\n-    }\n-    \n-    // 'ì „ì²´' ì§€ì ì´ ì´ë¯¸ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸ (master01ê³¼ ë™ì¼í•œ ë°©ì‹)\n-    let defaultBranch = await dbManager.getBranchByName('ì „ì²´');\n-    \n-    if (!defaultBranch) {\n-      console.log(\"'ì „ì²´' ì§€ì ì„ ìƒì„±í•©ë‹ˆë‹¤.\");\n-      defaultBranch = await dbManager.addBranch({\n-        name: 'ì „ì²´',\n-        address: '',\n-        phone: '',\n-        isActive: true\n-      });\n-      console.log(\"'ì „ì²´' ì§€ì ì´ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.\");\n-    } else {\n-      console.log(\"'ì „ì²´' ì§€ì ì´ ì´ë¯¸ ì¡´ì¬í•©ë‹ˆë‹¤.\");\n-    }\n-    \n-    // ì‹œìŠ¤í…œ ê´€ë¦¬ì ê³„ì • ìƒì„±\n-    console.log('ì‹œìŠ¤í…œ ê´€ë¦¬ì ê³„ì •ì„ ìƒì„±í•©ë‹ˆë‹¤.');\n-    await dbManager.addStaff({\n-      name: SYSTEM_ADMIN_CONFIG.SYSTEM_ADMIN_DISPLAY_NAME,\n-      loginId: SYSTEM_ADMIN_CONFIG.SYSTEM_ADMIN_LOGIN_ID,\n-      password: SYSTEM_ADMIN_CONFIG.TEMP_PASSWORD,\n-      email: 'admin@lavida.com', // ì„ì‹œ ì´ë©”ì¼\n-      phone: '010-0000-0000', // ì„ì‹œ ì „í™”ë²ˆí˜¸\n-      branchId: defaultBranch.id, // ì°¾ì€ ë˜ëŠ” ìƒì„±ëœ 'ì „ì²´' ì§€ì  ì‚¬ìš©\n-      position: 'ëŒ€í‘œ',\n-      role: 'ì„¼í„°ì¥',\n-      employmentType: 'ì •ê·œì§',\n-      permission: 'MASTER',\n-      contractStartDate: new Date(),\n-      contractEndDate: null, // ì •ê·œì§ì´ë¯€ë¡œ ê³„ì•½ì¢…ë£Œì¼ ì—†ìŒ\n-    });\n-    \n-    console.log('ì‹œìŠ¤í…œ ê´€ë¦¬ì ê³„ì •ì´ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.');\n-    return true; // ìƒˆë¡œìš´ ê³„ì •ì´ ìƒì„±ë¨\n-  } catch (error) {\n-    console.error('ì‹œìŠ¤í…œ ê´€ë¦¬ì ì´ˆê¸°í™” ì‹¤íŒ¨:', error);\n-    return false;\n-  }\n-};\n-\n-/**\n- * ì‹œìŠ¤í…œì´ ì´ˆê¸° ì„¤ì • ìƒíƒœì¸ì§€ í™•ì¸\n- * - ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ ê¸°ë³¸ ì •ë³´(ì„ì‹œ ì´ë©”ì¼, ì „í™”ë²ˆí˜¸)ë¥¼ ì‚¬ìš©í•˜ê³  ìˆëŠ”ì§€ í™•ì¸\n- */\n-export const isSystemInInitialState = async (): Promise<boolean> => {\n-  try {\n-    const systemAdmin = await dbManager.getStaffByLoginId(SYSTEM_ADMIN_CONFIG.SYSTEM_ADMIN_LOGIN_ID);\n-    \n-    if (!systemAdmin) {\n-      return true; // ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ ì—†ìœ¼ë©´ ì´ˆê¸° ìƒíƒœ\n-    }\n-    \n-    // ì„ì‹œ ì •ë³´ë¥¼ ì‚¬ìš©í•˜ê³  ìˆëŠ”ì§€ í™•ì¸\n-    const hasTemporaryEmail = systemAdmin.email === 'admin@lavida.com';\n-    const hasTemporaryPhone = systemAdmin.phone === '010-0000-0000';\n-    \n-    return hasTemporaryEmail || hasTemporaryPhone;\n-  } catch (error) {\n-    console.error('ì‹œìŠ¤í…œ ì´ˆê¸° ìƒíƒœ í™•ì¸ ì‹¤íŒ¨:', error);\n-    return true; // ì˜¤ë¥˜ ì‹œ ì´ˆê¸° ìƒíƒœë¡œ ê°„ì£¼\n-  }\n-};\n-\n-/**\n- * ì‹œìŠ¤í…œ ì´ˆê¸° ì„¤ì • ì™„ë£Œ ì²˜ë¦¬\n- * ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ ì •ë³´ë¥¼ ì—…ë°ì´íŠ¸í–ˆì„ ë•Œ í˜¸ì¶œ\n- */\n-export const markSystemInitialized = async (): Promise<void> => {\n-  // í˜„ì¬ëŠ” ë³„ë„ í”Œë˜ê·¸ ì—†ì´ ì‹œìŠ¤í…œ ê´€ë¦¬ì ì •ë³´ë¡œë§Œ íŒë‹¨\n-  // í•„ìš”ì‹œ localStorage ë˜ëŠ” ë³„ë„ ì„¤ì • í…Œì´ë¸” ì‚¬ìš© ê°€ëŠ¥\n-};\n-\n-/**\n- * ì‹œìŠ¤í…œ ìµœì´ˆ ì‹¤í–‰ ì‹œ ìë™ ì´ˆê¸°í™”\n- * App.tsxì—ì„œ í˜¸ì¶œí•˜ì—¬ ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ ì—†ìœ¼ë©´ ìë™ ìƒì„±\n- */\n-export const autoInitializeSystem = async (): Promise<void> => {\n-  try {\n-    await initializeSystemAdmin();\n-  } catch (error) {\n-    console.error('ì‹œìŠ¤í…œ ìë™ ì´ˆê¸°í™” ì‹¤íŒ¨:', error);\n-  }\n-};\n"
                },
                {
                    "date": 1760074506212,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -76,8 +76,9 @@\n       employmentType: 'ì •ê·œì§',\n       permission: 'MASTER',\n       contractStartDate: new Date(),\n       contractEndDate: null, // ì •ê·œì§ì´ë¯€ë¡œ ê³„ì•½ì¢…ë£Œì¼ ì—†ìŒ\n+      isActive: true, // ì‹œìŠ¤í…œ ê´€ë¦¬ìëŠ” ê¸°ë³¸ì ìœ¼ë¡œ í™œì„± ìƒíƒœ\n     });\n     \n     console.log('ì‹œìŠ¤í…œ ê´€ë¦¬ì ê³„ì •ì´ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.');\n     return true; // ìƒˆë¡œìš´ ê³„ì •ì´ ìƒì„±ë¨\n"
                },
                {
                    "date": 1760755500672,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -43,28 +43,35 @@\n  * ì‹œìŠ¤í…œ ìµœì´ˆ ì‹¤í–‰ ì‹œ ë˜ëŠ” ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ ì—†ì„ ë•Œ í˜¸ì¶œ\n  */\n export const initializeSystemAdmin = async (): Promise<boolean> => {\n   try {\n+    console.log('ğŸ” ì‹œìŠ¤í…œ ê´€ë¦¬ì ì¡´ì¬ ì—¬ë¶€ í™•ì¸ ì¤‘...');\n+    \n     // ì´ë¯¸ ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸\n     const existingAdmin = await dbManager.getStaffByLoginId(SYSTEM_ADMIN_CONFIG.SYSTEM_ADMIN_LOGIN_ID);\n     \n     if (existingAdmin) {\n       // ì´ë¯¸ ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ ì¡´ì¬í•¨\n-      console.log('ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ ì´ë¯¸ ì¡´ì¬í•©ë‹ˆë‹¤.');\n+      console.log('âœ… ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ ì´ë¯¸ ì¡´ì¬í•©ë‹ˆë‹¤.');\n       return false;\n     }\n+\n+    console.log('ğŸ“‹ ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ ì—†ìŠµë‹ˆë‹¤. ìƒˆë¡œ ìƒì„±í•©ë‹ˆë‹¤...');\n     \n+    // IndexedDB ì—°ê²° ìƒíƒœ í™•ì¸\n+    await ensureDatabaseConnection();\n+    \n     // 'ì „ì²´' ì§€ì  í™•ì¸ ë˜ëŠ” ìƒì„± (ì›ìì  ì²˜ë¦¬ë¡œ ì¤‘ë³µ ë°©ì§€)\n-    console.log(\"'ì „ì²´' ì§€ì ì„ í™•ì¸í•˜ê±°ë‚˜ ìƒì„±í•©ë‹ˆë‹¤.\");\n+    console.log(\"ğŸ¢ 'ì „ì²´' ì§€ì ì„ í™•ì¸í•˜ê±°ë‚˜ ìƒì„±í•©ë‹ˆë‹¤...\");\n     const defaultBranch = await dbManager.getOrCreateBranchByName('ì „ì²´', {\n       address: '',\n       phone: '',\n       isActive: true\n     });\n-    console.log(\"'ì „ì²´' ì§€ì  ì²˜ë¦¬ ì™„ë£Œ:\", defaultBranch.id);\n-    \n+    console.log(\"âœ… 'ì „ì²´' ì§€ì  ì²˜ë¦¬ ì™„ë£Œ:\", defaultBranch.id);\n+\n     // ì‹œìŠ¤í…œ ê´€ë¦¬ì ê³„ì • ìƒì„±\n-    console.log('ì‹œìŠ¤í…œ ê´€ë¦¬ì ê³„ì •ì„ ìƒì„±í•©ë‹ˆë‹¤.');\n+    console.log('ğŸ‘¤ ì‹œìŠ¤í…œ ê´€ë¦¬ì ê³„ì •ì„ ìƒì„±í•©ë‹ˆë‹¤...');\n     await dbManager.addStaff({\n       name: SYSTEM_ADMIN_CONFIG.SYSTEM_ADMIN_DISPLAY_NAME,\n       loginId: SYSTEM_ADMIN_CONFIG.SYSTEM_ADMIN_LOGIN_ID,\n       password: SYSTEM_ADMIN_CONFIG.TEMP_PASSWORD,\n@@ -78,18 +85,52 @@\n       contractStartDate: new Date(),\n       contractEndDate: null, // ì •ê·œì§ì´ë¯€ë¡œ ê³„ì•½ì¢…ë£Œì¼ ì—†ìŒ\n       isActive: true, // ì‹œìŠ¤í…œ ê´€ë¦¬ìëŠ” ê¸°ë³¸ì ìœ¼ë¡œ í™œì„± ìƒíƒœ\n     });\n+\n+    console.log('ğŸ‰ ì‹œìŠ¤í…œ ê´€ë¦¬ì ê³„ì •ì´ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!');\n     \n-    console.log('ì‹œìŠ¤í…œ ê´€ë¦¬ì ê³„ì •ì´ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.');\n-    return true; // ìƒˆë¡œìš´ ê³„ì •ì´ ìƒì„±ë¨\n+    // ìƒì„± í™•ì¸\n+    const verifyAdmin = await dbManager.getStaffByLoginId(SYSTEM_ADMIN_CONFIG.SYSTEM_ADMIN_LOGIN_ID);\n+    if (verifyAdmin) {\n+      console.log('âœ… ì‹œìŠ¤í…œ ê´€ë¦¬ì ìƒì„± ê²€ì¦ ì™„ë£Œ:', verifyAdmin.name);\n+      return true; // ìƒˆë¡œìš´ ê³„ì •ì´ ìƒì„±ë¨\n+    } else {\n+      console.error('âŒ ì‹œìŠ¤í…œ ê´€ë¦¬ì ìƒì„± ê²€ì¦ ì‹¤íŒ¨');\n+      return false;\n+    }\n   } catch (error) {\n-    console.error('ì‹œìŠ¤í…œ ê´€ë¦¬ì ì´ˆê¸°í™” ì‹¤íŒ¨:', error);\n+    console.error('âŒ ì‹œìŠ¤í…œ ê´€ë¦¬ì ì´ˆê¸°í™” ì‹¤íŒ¨:', error);\n     return false;\n   }\n };\n \n /**\n+ * IndexedDB ì—°ê²°ì´ í™•ì‹¤íˆ ì¤€ë¹„ë˜ì—ˆëŠ”ì§€ í™•ì¸\n+ */\n+const ensureDatabaseConnection = async (): Promise<void> => {\n+  let attempts = 0;\n+  const maxAttempts = 5;\n+  \n+  while (attempts < maxAttempts) {\n+    try {\n+      // ê°„ë‹¨í•œ ì—°ê²° í…ŒìŠ¤íŠ¸\n+      await dbManager.getAllBranches();\n+      console.log('âœ… IndexedDB ì—°ê²° í™•ì¸ë¨');\n+      return;\n+    } catch (error) {\n+      attempts++;\n+      console.log(`ğŸ”„ IndexedDB ì—°ê²° ì¬ì‹œë„... (${attempts}/${maxAttempts})`);\n+      \n+      if (attempts >= maxAttempts) {\n+        throw new Error('IndexedDB ì—°ê²°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');\n+      }\n+      \n+      // 500ms ëŒ€ê¸° í›„ ì¬ì‹œë„\n+      await new Promise(resolve => setTimeout(resolve, 500));\n+    }\n+  }\n+};/**\n  * ì‹œìŠ¤í…œì´ ì´ˆê¸° ì„¤ì • ìƒíƒœì¸ì§€ í™•ì¸ (ë” ì´ìƒ ëª¨ë‹¬ íŒì—…ìš©ìœ¼ë¡œ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ)\n  * - ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ ê¸°ë³¸ ì •ë³´(ì„ì‹œ ì´ë©”ì¼, ì „í™”ë²ˆí˜¸)ë¥¼ ì‚¬ìš©í•˜ê³  ìˆëŠ”ì§€ í™•ì¸\n  * - ì´ì œ ë‹¨ìˆœ ì •ë³´ í™•ì¸ìš©ìœ¼ë¡œë§Œ ì‚¬ìš©\n  */\n@@ -126,15 +167,38 @@\n  * App.tsxì—ì„œ í˜¸ì¶œí•˜ì—¬ ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ ì—†ìœ¼ë©´ ìë™ ìƒì„±\n  */\n export const autoInitializeSystem = async (): Promise<void> => {\n   try {\n+    console.log('ğŸš€ ì‹œìŠ¤í…œ ìë™ ì´ˆê¸°í™”ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤...');\n+    \n     // ë¨¼ì € ê¸°ì¡´ ì¤‘ë³µ ë°ì´í„° ì •ë¦¬ (í•œ ë²ˆë§Œ ì‹¤í–‰)\n     if (!localStorage.getItem('lavida_cleanup_done')) {\n+      console.log('ğŸ§¹ ì¤‘ë³µ ë°ì´í„° ì •ë¦¬ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤...');\n       await cleanupDuplicateBranches();\n       localStorage.setItem('lavida_cleanup_done', 'true');\n+      console.log('âœ… ì¤‘ë³µ ë°ì´í„° ì •ë¦¬ ì™„ë£Œ');\n     }\n     \n-    await initializeSystemAdmin();\n+    // ì‹œìŠ¤í…œ ê´€ë¦¬ì ì´ˆê¸°í™”\n+    const adminCreated = await initializeSystemAdmin();\n+    \n+    if (adminCreated) {\n+      console.log('ğŸ‰ ìƒˆë¡œìš´ ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!');\n+    } else {\n+      console.log('â„¹ï¸ ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ ì´ë¯¸ ì¡´ì¬í•˜ê±°ë‚˜ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');\n+    }\n+    \n+    console.log('âœ… ì‹œìŠ¤í…œ ìë™ ì´ˆê¸°í™” ì™„ë£Œ');\n   } catch (error) {\n-    console.error('ì‹œìŠ¤í…œ ìë™ ì´ˆê¸°í™” ì‹¤íŒ¨:', error);\n+    console.error('âŒ ì‹œìŠ¤í…œ ìë™ ì´ˆê¸°í™” ì‹¤íŒ¨:', error);\n+    \n+    // ì¬ì‹œë„ ë¡œì§ (í•œ ë²ˆë§Œ)\n+    try {\n+      console.log('ğŸ”„ ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì¬ì‹œë„...');\n+      await new Promise(resolve => setTimeout(resolve, 1000)); // 1ì´ˆ ëŒ€ê¸°\n+      await initializeSystemAdmin();\n+      console.log('âœ… ì¬ì‹œë„ë¡œ ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì„±ê³µ');\n+    } catch (retryError) {\n+      console.error('âŒ ì¬ì‹œë„ë„ ì‹¤íŒ¨:', retryError);\n+    }\n   }\n };\n"
                },
                {
                    "date": 1760755816562,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -74,12 +74,12 @@\n     await dbManager.addStaff({\n       name: SYSTEM_ADMIN_CONFIG.SYSTEM_ADMIN_DISPLAY_NAME,\n       loginId: SYSTEM_ADMIN_CONFIG.SYSTEM_ADMIN_LOGIN_ID,\n       password: SYSTEM_ADMIN_CONFIG.TEMP_PASSWORD,\n-      email: 'admin@lavida.com', // ì„ì‹œ ì´ë©”ì¼\n-      phone: '010-0000-0000', // ì„ì‹œ ì „í™”ë²ˆí˜¸\n+      email: SYSTEM_ADMIN_CONFIG.DEFAULT_EMAIL,\n+      phone: SYSTEM_ADMIN_CONFIG.DEFAULT_PHONE,\n       branchId: defaultBranch.id, // ì°¾ì€ ë˜ëŠ” ìƒì„±ëœ 'ì „ì²´' ì§€ì  ì‚¬ìš©\n-      position: 'ëŒ€í‘œ',\n+      position: SYSTEM_ADMIN_CONFIG.DEFAULT_POSITION,\n       role: 'ì„¼í„°ì¥',\n       employmentType: 'ì •ê·œì§',\n       permission: 'MASTER',\n       contractStartDate: new Date(),\n@@ -130,9 +130,9 @@\n     }\n   }\n };/**\n  * ì‹œìŠ¤í…œì´ ì´ˆê¸° ì„¤ì • ìƒíƒœì¸ì§€ í™•ì¸ (ë” ì´ìƒ ëª¨ë‹¬ íŒì—…ìš©ìœ¼ë¡œ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ)\n- * - ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ ê¸°ë³¸ ì •ë³´(ì„ì‹œ ì´ë©”ì¼, ì „í™”ë²ˆí˜¸)ë¥¼ ì‚¬ìš©í•˜ê³  ìˆëŠ”ì§€ í™•ì¸\n+ * - ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ ê¸°ë³¸ ì •ë³´ë¥¼ ì‚¬ìš©í•˜ê³  ìˆëŠ”ì§€ í™•ì¸\n  * - ì´ì œ ë‹¨ìˆœ ì •ë³´ í™•ì¸ìš©ìœ¼ë¡œë§Œ ì‚¬ìš©\n  */\n export const isSystemInInitialState = async (): Promise<boolean> => {\n   try {\n@@ -141,13 +141,13 @@\n     if (!systemAdmin) {\n       return true; // ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ ì—†ìœ¼ë©´ ì´ˆê¸° ìƒíƒœ\n     }\n     \n-    // ì„ì‹œ ì •ë³´ë¥¼ ì‚¬ìš©í•˜ê³  ìˆëŠ”ì§€ í™•ì¸ (ì •ë³´ìš©ìœ¼ë¡œë§Œ ì‚¬ìš©)\n-    const hasTemporaryEmail = systemAdmin.email === 'admin@lavida.com';\n-    const hasTemporaryPhone = systemAdmin.phone === '010-0000-0000';\n+    // ì„¤ì •ëœ ê¸°ë³¸ ì •ë³´ë¥¼ ì‚¬ìš©í•˜ê³  ìˆëŠ”ì§€ í™•ì¸ (ì •ë³´ìš©ìœ¼ë¡œë§Œ ì‚¬ìš©)\n+    const hasDefaultEmail = systemAdmin.email === SYSTEM_ADMIN_CONFIG.DEFAULT_EMAIL;\n+    const hasDefaultPhone = systemAdmin.phone === SYSTEM_ADMIN_CONFIG.DEFAULT_PHONE;\n     \n-    return hasTemporaryEmail || hasTemporaryPhone;\n+    return hasDefaultEmail && hasDefaultPhone;\n   } catch (error) {\n     console.error('ì‹œìŠ¤í…œ ì´ˆê¸° ìƒíƒœ í™•ì¸ ì‹¤íŒ¨:', error);\n     return true; // ì˜¤ë¥˜ ì‹œ ì´ˆê¸° ìƒíƒœë¡œ ê°„ì£¼\n   }\n"
                },
                {
                    "date": 1763550816335,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -68,8 +68,25 @@\n       isActive: true\n     });\n     console.log(\"âœ… 'ì „ì²´' ì§€ì  ì²˜ë¦¬ ì™„ë£Œ:\", defaultBranch.id);\n \n+    // 'ì „ì²´' ì§€ì ì— ê¸°ë³¸ ì¶”ì²œ í¬ì¸íŠ¸ ì„¤ì • ìƒì„±\n+    console.log(\"ğŸ 'ì „ì²´' ì§€ì  ê¸°ë³¸ ì¶”ì²œ í¬ì¸íŠ¸ ì„¤ì •ì„ í™•ì¸í•©ë‹ˆë‹¤...\");\n+    const existingReferralSettings = await dbManager.referralPoint.getReferralPointSettingsByBranchId(defaultBranch.id);\n+    \n+    if (!existingReferralSettings) {\n+      await dbManager.referralPoint.addReferralPointSettings({\n+        branchId: defaultBranch.id,\n+        branchName: 'ì „ì²´',\n+        referrerPoints: 40000, // ì¶”ì²œí•œ ì‚¬ëŒ ê¸°ë³¸ 40,000P (ê¸°ì¡´ í•˜ë“œì½”ë”© ê°’)\n+        referredPoints: 35000, // ì¶”ì²œë°›ì€ ì‚¬ëŒ ê¸°ë³¸ 35,000P (ê¸°ì¡´ í•˜ë“œì½”ë”© ê°’)\n+        isActive: true,\n+      });\n+      console.log(\"âœ… 'ì „ì²´' ì§€ì  ê¸°ë³¸ ì¶”ì²œ í¬ì¸íŠ¸ ì„¤ì • ìƒì„± ì™„ë£Œ (40,000P / 35,000P)\");\n+    } else {\n+      console.log(\"âœ… 'ì „ì²´' ì§€ì  ì¶”ì²œ í¬ì¸íŠ¸ ì„¤ì •ì´ ì´ë¯¸ ì¡´ì¬í•©ë‹ˆë‹¤.\");\n+    }\n+\n     // ì‹œìŠ¤í…œ ê´€ë¦¬ì ê³„ì • ìƒì„±\n     console.log('ğŸ‘¤ ì‹œìŠ¤í…œ ê´€ë¦¬ì ê³„ì •ì„ ìƒì„±í•©ë‹ˆë‹¤...');\n     await dbManager.addStaff({\n       name: SYSTEM_ADMIN_CONFIG.SYSTEM_ADMIN_DISPLAY_NAME,\n"
                }
            ],
            "date": 1759911046491,
            "name": "Commit-0",
            "content": "/**\n * ì‹œìŠ¤í…œ ì´ˆê¸°í™” ê´€ë ¨ ìœ í‹¸ë¦¬í‹°\n * ì‹œìŠ¤í…œ ê´€ë¦¬ì ìë™ ìƒì„± ë° ì´ˆê¸° ì„¤ì •\n */\n\nimport { dbManager } from './indexedDB';\nimport { SYSTEM_ADMIN_CONFIG } from '../constants/staffConstants';\n\n/**\n * ì‹œìŠ¤í…œ ê´€ë¦¬ì ê³„ì • ìë™ ìƒì„±\n * ì‹œìŠ¤í…œ ìµœì´ˆ ì‹¤í–‰ ì‹œ ë˜ëŠ” ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ ì—†ì„ ë•Œ í˜¸ì¶œ\n */\nexport const initializeSystemAdmin = async (): Promise<boolean> => {\n  try {\n    // ì´ë¯¸ ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸\n    const existingAdmin = await dbManager.getStaffByLoginId(SYSTEM_ADMIN_CONFIG.SYSTEM_ADMIN_LOGIN_ID);\n    \n    if (existingAdmin) {\n      // ì´ë¯¸ ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ ì¡´ì¬í•¨\n      return false;\n    }\n    \n    // ê¸°ë³¸ ì§€ì ì´ ì—†ìœ¼ë©´ ìƒì„±\n    let branches = await dbManager.getAllBranches();\n    if (branches.length === 0) {\n      const defaultBranch = await dbManager.addBranch({\n        name: 'ë³¸ì‚¬',\n        address: '',\n        phone: '',\n        isActive: true\n      });\n      branches = [defaultBranch];\n    }\n    \n    // ì‹œìŠ¤í…œ ê´€ë¦¬ì ê³„ì • ìƒì„±\n    await dbManager.addStaff({\n      name: SYSTEM_ADMIN_CONFIG.SYSTEM_ADMIN_DISPLAY_NAME,\n      loginId: SYSTEM_ADMIN_CONFIG.SYSTEM_ADMIN_LOGIN_ID,\n      password: SYSTEM_ADMIN_CONFIG.TEMP_PASSWORD,\n      email: 'admin@lavida.com', // ì„ì‹œ ì´ë©”ì¼\n      phone: '010-0000-0000', // ì„ì‹œ ì „í™”ë²ˆí˜¸\n      branchId: branches[0].id,\n      position: 'ëŒ€í‘œ',\n      role: 'ì„¼í„°ì¥',\n      employmentType: 'ì •ê·œì§',\n      permission: 'MASTER',\n      contractStartDate: new Date(),\n      contractEndDate: new Date(Date.now() + 365 * 24 * 60 * 60 * 1000), // 1ë…„ í›„\n    });\n    \n    return true; // ìƒˆë¡œìš´ ê³„ì •ì´ ìƒì„±ë¨\n  } catch (error) {\n    console.error('ì‹œìŠ¤í…œ ê´€ë¦¬ì ì´ˆê¸°í™” ì‹¤íŒ¨:', error);\n    return false;\n  }\n};\n\n/**\n * ì‹œìŠ¤í…œì´ ì´ˆê¸° ì„¤ì • ìƒíƒœì¸ì§€ í™•ì¸\n * - ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ ê¸°ë³¸ ì •ë³´(ì„ì‹œ ì´ë©”ì¼, ì „í™”ë²ˆí˜¸)ë¥¼ ì‚¬ìš©í•˜ê³  ìˆëŠ”ì§€ í™•ì¸\n */\nexport const isSystemInInitialState = async (): Promise<boolean> => {\n  try {\n    const systemAdmin = await dbManager.getStaffByLoginId(SYSTEM_ADMIN_CONFIG.SYSTEM_ADMIN_LOGIN_ID);\n    \n    if (!systemAdmin) {\n      return true; // ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ ì—†ìœ¼ë©´ ì´ˆê¸° ìƒíƒœ\n    }\n    \n    // ì„ì‹œ ì •ë³´ë¥¼ ì‚¬ìš©í•˜ê³  ìˆëŠ”ì§€ í™•ì¸\n    const hasTemporaryEmail = systemAdmin.email === 'admin@lavida.com';\n    const hasTemporaryPhone = systemAdmin.phone === '010-0000-0000';\n    \n    return hasTemporaryEmail || hasTemporaryPhone;\n  } catch (error) {\n    console.error('ì‹œìŠ¤í…œ ì´ˆê¸° ìƒíƒœ í™•ì¸ ì‹¤íŒ¨:', error);\n    return true; // ì˜¤ë¥˜ ì‹œ ì´ˆê¸° ìƒíƒœë¡œ ê°„ì£¼\n  }\n};\n\n/**\n * ì‹œìŠ¤í…œ ì´ˆê¸° ì„¤ì • ì™„ë£Œ ì²˜ë¦¬\n * ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ ì •ë³´ë¥¼ ì—…ë°ì´íŠ¸í–ˆì„ ë•Œ í˜¸ì¶œ\n */\nexport const markSystemInitialized = async (): Promise<void> => {\n  // í˜„ì¬ëŠ” ë³„ë„ í”Œë˜ê·¸ ì—†ì´ ì‹œìŠ¤í…œ ê´€ë¦¬ì ì •ë³´ë¡œë§Œ íŒë‹¨\n  // í•„ìš”ì‹œ localStorage ë˜ëŠ” ë³„ë„ ì„¤ì • í…Œì´ë¸” ì‚¬ìš© ê°€ëŠ¥\n};\n\n/**\n * ì‹œìŠ¤í…œ ìµœì´ˆ ì‹¤í–‰ ì‹œ ìë™ ì´ˆê¸°í™”\n * App.tsxì—ì„œ í˜¸ì¶œí•˜ì—¬ ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ ì—†ìœ¼ë©´ ìë™ ìƒì„±\n */\nexport const autoInitializeSystem = async (): Promise<void> => {\n  try {\n    await initializeSystemAdmin();\n  } catch (error) {\n    console.error('ì‹œìŠ¤í…œ ìë™ ì´ˆê¸°í™” ì‹¤íŒ¨:', error);\n  }\n};\n"
        }
    ]
}